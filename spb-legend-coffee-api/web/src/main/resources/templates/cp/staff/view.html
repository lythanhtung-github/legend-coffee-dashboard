<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <th:block th:replace="/cp/layout/header :: header-utils"/>
    <th:block th:replace="/cp/layout/header :: header-logo"/>
    <th:block th:replace="/cp/layout/header :: header-perfect-scrollbar"/>
    <th:block th:replace="/cp/layout/header :: header-material-design"/>
    <th:block th:replace="/cp/layout/header :: header-app-css"/>
    <th:block th:replace="/cp/layout/header :: header-fontawesome"/>

    <title>Legend Coffee</title>

</head>
<body>
<div class="be-wrapper">

    <th:block th:replace="/cp/layout/top-header :: top-header"/>

    <th:block th:replace="/cp/layout/left-sidebar :: left-sidebar"/>

    <div class="be-content">
        <div class="main-content container-fluid">
            <div class="user-profile">
                <div class="row">
                    <div class="col-lg-5">
                        <div class="user-display">
                            <div class="user-display-bg"><img src="/assets/img/user-profile-display.png"
                                                              alt="Profile Background"></div>
                            <div class="user-display-bottom">
                                <div class="user-display-avatar">
                                    <img id="imageViewStaff" src="" alt="Hình ảnh nhân viên">
                                </div>
                                <div class="user-display-info">
                                    <div class="name" id="fullNameViewStaff">Lý Thanh Tùng</div>
                                </div>
                                <div class="row user-display-details">
                                    <div class="col-4">
                                        <div class="title">Lượt xem</div>
                                        <div class="counter">26</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="title">Lượt thích</div>
                                        <div class="counter">26</div>
                                    </div>
                                    <div class="col-4">
                                        <div class="title">Theo dõi</div>
                                        <div class="counter">26</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="user-info-list card">
                            <div class="card-header card-header-divider">Giới thiệu bản thân
                                <span class="card-subtitle" id="profileViewStaff">
                                </span>
                            </div>
                            <div class="card-body">
                                <table class="no-border no-strip skills">
                                    <tbody class="no-border-x no-border-y">
                                    <tr>
                                        <td class="icon"><span class="mdi mdi-case"></span></td>
                                        <td class="item">Chức danh<span class="icon s7-portfolio"></span></td>
                                        <td>
                                            <div id="roleViewStaff">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="icon"><span class="mdi mdi-cake"></span></td>
                                        <td class="item">Ngày sinh<span class="icon s7-gift"></span></td>
                                        <td>
                                            <div id="dobViewStaff"></div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="icon"><span class="mdi mdi-mail-reply"></span></td>
                                        <td class="item">Email<span class="icon s7-mail"></span></td>
                                        <td>
                                            <div id="emailViewStaff"></div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="icon"><span class="mdi mdi-smartphone-android"></span></td>
                                        <td class="item">Số điện thoại<span class="icon s7-phone"></span></td>
                                        <td>
                                            <div id="phoneViewStaff"></div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="icon"><span class="mdi mdi-globe-alt"></span></td>
                                        <td class="item">Địa chỉ<span class="icon s7-map-marker"></span></td>
                                        <td>
                                            <div id="addressViewStaff"></div>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-7">
                        <div class="widget widget-fullwidth widget-small">
                            <div class="widget-head pb-6">
                                <div class="tools"><span class="icon mdi mdi-chevron-down"></span><span
                                        class="icon mdi mdi-refresh-sync"></span><span
                                        class="icon mdi mdi-close"></span></div>
                                <div class="title">Hoạt động phát triển</div>
                            </div>
                            <div class="widget-chart-container">
                                <div id="bar-chart1" style="height: 180px;"></div>
                                <table class="table table-striped table-hover">
                                    <thead>
                                    <tr>
                                        <th style="width:37%;">Người dùng</th>
                                        <th style="width:36%;">Hành động</th>
                                        <th>Thời gian</th>
                                        <th class="actions"></th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    <tr>
                                        <td class="user-avatar"><img src="/assets/img/avatar6.png" alt="Avatar">
                                            Mỹ Tâm
                                        </td>
                                        <td>Ăn uống</td>
                                        <td>2022-12-12</td>
                                        <td class="actions"><a class="icon" href="#"><i class="mdi mdi-delete"></i></a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="user-avatar"><img src="/assets/img/avatar4.png" alt="Avatar">
                                            Tuấn Hưng
                                        </td>
                                        <td>Ăn uống</td>
                                        <td>2022-10-12</td>
                                        <td class="actions"><a class="icon" href="#"><i class="mdi mdi-delete"></i></a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="user-avatar"><img src="/assets/img/avatar5.png" alt="Avatar">
                                            Phương Mỹ Chi
                                        </td>
                                        <td>Ăn uống</td>
                                        <td>2022-09-10</td>
                                        <td class="actions"><a class="icon" href="#"><i class="mdi mdi-delete"></i></a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="user-avatar"><img src="/assets/img/avatar3.png" alt="Avatar">
                                            Nguyễn Minh Hiếu
                                        </td>
                                        <td>Ăn uống</td>
                                        <td>2022-12-09</td>
                                        <td class="actions"><a class="icon" href="#"><i class="mdi mdi-delete"></i></a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="user-avatar"><img src="/assets/img/avatar.png" alt="Avatar">
                                            Thái Học
                                        </td>
                                        <td>Ăn uống</td>
                                        <td>2022-12-10</td>
                                        <td class="actions"><a class="icon" href="#"><i class="mdi mdi-delete"></i></a>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="user-avatar"><img src="/assets/img/avatar2.png" alt="Avatar">
                                            Hoàng Thùy Linh
                                        </td>
                                        <td>Ăn uống</td>
                                        <td>2022-01-01</td>
                                        <td class="actions"><a class="icon" href="#"><i class="mdi mdi-delete"></i></a>
                                        </td>
                                    </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <th:block th:replace="/cp/layout/right-sidebar :: right-sidebar"/>
</div>

<th:block th:replace="/cp/layout/script :: script-jquery"/>
<th:block th:replace="/cp/layout/script :: script-perfect-scrollbar"/>
<th:block th:replace="/cp/layout/script :: script-boostrap"/>
<th:block th:replace="/cp/layout/script :: script-app"/>
<th:block th:replace="/cp/layout/script :: script-appUtils"/>
<th:block th:replace="/cp/layout/script :: script-flot"/>

<script type="text/javascript">
    const page = {
        urls: {
            getStaffById: AppUtils.STAFF_API,
        },
        elements: {},
        commands: {},
        initializeEventControl: {}
    }

    page.elements.imageViewStaff = $("#imageViewStaff");
    page.elements.fullNameViewStaff = $("#fullNameViewStaff");
    page.elements.profileViewStaff = $("#profileViewStaff");
    page.elements.roleViewStaff = $("#roleViewStaff");
    page.elements.dobViewStaff = $("#dobViewStaff");
    page.elements.phoneViewStaff = $("#phoneViewStaff");
    page.elements.emailViewStaff = $("#emailViewStaff");
    page.elements.addressViewStaff = $("#addressViewStaff");

    page.commands.getStaffById = () => {
        let tempArray = location.href.split("/");
        let staffId = tempArray.at(-1);
        return $.ajax({
            type: "GET",
            url: page.urls.getStaffById + "/" + staffId
        }).done((data) => {
            console.log(data)
            page.elements.imageViewStaff.attr("src", data.staffAvatar.fileUrl);
            page.elements.fullNameViewStaff.text(data.fullName);
            page.elements.profileViewStaff.text("Xin chào! Tôi tên là " + data.fullName + " đến từ " + data.locationRegion.provinceName);
            data.user.role.code == "ADMIN" ?
                page.elements.roleViewStaff.text("Quản trị viên") :
                data.user.role.code == "CASHIER" ?
                    page.elements.roleViewStaff.text("Thu ngân") :
                    page.elements.roleViewStaff.text("Nhân viên");
            page.elements.dobViewStaff.text(data.dob);
            page.elements.phoneViewStaff.text(data.phone);
            page.elements.emailViewStaff.text(data.user.username);
            page.elements.addressViewStaff.text(`${data.locationRegion.address}, ${data.locationRegion.wardName}, ${data.locationRegion.districtName}, ${data.locationRegion.provinceName}`);
        })
            .fail((jqXHR) => {
                let errors = jqXHR.responseJSON;
                if (errors) {
                    let str = "";
                    $.each(errors, (k, v) => {
                        str += `
                            ${v}
                        `;
                    })
                    AppUtils.SweetAlert.showErrorAlert(str);
                }
            })
    }


    page.commands.loadData = () => {
        page.commands.getStaffById();
    }

    page.initializeEventControl = () => {

    }

    $(() => {
        App.init();
        App.pageProfile();
        page.commands.loadData();
        page.initializeEventControl();
    });
</script>
</body>
</html>